function toggleLoading(){isLoading?($("#loader").hide(),$("#form-starwars").show()):($("#loader").show(),$("#form-starwars").hide()),isLoading=!isLoading}StarWarsOpening=function(){function t(t){this.el=$(t.el),this.audio=this.el.find("audio").get(0),this.start=this.el.find(".start"),this.animation=this.el.find(".animation"),this.reset(),$(this.audio).bind("ended",$.proxy(function(){this.audio.currentTime=0,this.reset(),setTimeout(function(){$("body").removeClass("running")},1e4)},this))}return t.prototype.reset=function(){this.start.show(),$(".pageHide").show(),this.cloned=this.animation.clone(!0),this.animation.remove(),this.animation=this.cloned},t.prototype.resetAudio=function(){this.audio.pause(),this.audio.currentTime=0},t.prototype.play=function(){this.start.hide(),$(".pageHide").hide(),$("body").removeClass("running"),$("body").addClass("running"),this.audio.play(),this.el.append(this.animation)},t}();var StarWars=new StarWarsOpening({el:".starwars"});swal.setDefaults({customClass:"star-wars-alert"});var notPlayed=!0,isLoading=!1,showFooter=!0;toggleLoading(),$("#form-starwars").submit(function(t){t.preventDefault();var i={intro:$("#f-intro").val(),episode:$("#f-episode").val(),title:$("#f-title").val(),text:$("#f-text").val()},a=new Firebase("https://starwarsopening.firebaseio.com/openings"),n=a.push(i);console.log(n.key().substring(1)),toggleLoading(),location.hash="!/"+n.key().substring(1)}),$(window).on("hashchange",function(){var t=location.hash.replace("#!/","").split("/")[0];if($("body").removeClass("running"),console.log(t),""!=t)try{var i=new Firebase("https://starwarsopening.firebaseio.com/openings/-"+t);i.on("value",function(t){toggleLoading();var i=t.val();if(console.log(i),null==i)return void sweetAlert("Oops...","Introduction not found!","error");StarWars.animation.find("#intro").text(i.intro),StarWars.animation.find("#episode").text(i.episode),StarWars.animation.find("#title").text(i.title);var a=i.text.split("\n"),n=StarWars.animation.find("#text");n.text("");for(var e in a)n.append($("<p>").text(a[e]));document.hasFocus()?(StarWars.play(),notPlayed=!1):$(window).focus(function(){notPlayed&&(StarWars.play(),notPlayed=!1)})},function(t){throw t})}catch(a){location.hash="",toggleLoading()}else notPlayed?toggleLoading():(StarWars.reset(),StarWars.resetAudio());ga("send","pageview",{page:location.pathname+location.search+location.hash})}),$(document).ready(function(){window.dispatchEvent(new Event("hashchange"))});