function toggleLoading(){isLoading?($("#loader").hide(),$("#form-starwars").show()):($("#loader").show(),$("#form-starwars").hide()),isLoading=!isLoading}StarWarsOpening=function(){function t(t){this.el=$(t.el),this.audio=this.el.find("audio").get(0),this.audioDefer=$.Deferred();var a=this;this.audio.oncanplaythrough=function(){a.audioDefer.resolve()},this.start=this.el.find(".start"),this.animation=this.el.find(".animation"),this.reset(),$(this.audio).bind("ended",$.proxy(function(){this.audio.currentTime=0,this.reset();var t=this.opening;$("#f-intro").val(t.intro),$("#f-logo").val(t.logo||"Star\nwars"),$("#f-episode").val(t.episode),$("#f-title").val(t.title),$("#f-text").val(t.text),setTimeout(function(){$("body").removeClass("running")},1e4)},this))}return t.prototype.reset=function(){this.start.show(),$(".pageHide").show(),this.cloned=this.animation.clone(!0),this.animation.remove(),this.animation=this.cloned,$(window).trigger("resize")},t.prototype.resetAudio=function(){this.audio.pause(),this.audio.currentTime=0},t.prototype.play=function(){this.start.hide(),$(".pageHide").hide(),$("#loader").hide(),$("body").removeClass("running"),$("body").addClass("running"),$("body").scrollTop(0),this.audio.play(),this.el.append(this.animation)},t}();var StarWars=new StarWarsOpening({el:".starwars"});swal.setDefaults({customClass:"star-wars-alert"});var audio=document.getElementsByTagName("audio")[0],audioIsLoaded=!1,loadData=function(){audioIsLoaded||(audio.load(),audioIsLoaded=!0)};document.body.addEventListener("touchstart",loadData),window.addEventListener("keydown",function(t){var a=document.activeElement.type||"";a.startsWith("text")||[32,37,38,39,40].indexOf(t.keyCode)>-1&&t.preventDefault()},!1);var notPlayed=!0,isLoading=!1,showFooter=!0;toggleLoading(),$("#form-starwars").submit(function(t){t.preventDefault();var a={intro:$("#f-intro").val(),logo:$("#f-logo").val(),episode:$("#f-episode").val(),title:$("#f-title").val(),text:$("#f-text").val()},o=a.logo.split("\n");return o.length>2?void sweetAlert("Oops...","Logo can't have more than 2 lines.","warning"):void $.ajax({url:"https://starwarsopening.firebaseio.com/openings.json",method:"POST",data:JSON.stringify(a),dataType:"json",success:function(t){toggleLoading(),location.hash="!/"+t.name.substring(1)}})}),$(window).on("hashchange",function(){$("#playBut").remove();var t=location.hash.replace("#!/","").split("/")[0];if($("body").removeClass("running"),""!=t)try{var a="https://starwarsopening.firebaseio.com/openings/-"+t+".json";$.ajax({url:a,success:function(t){if(null==t)return void sweetAlert("Oops...","Introduction not found!","error");StarWars.opening=t;var a=t.intro.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;"),a=a.replace(/\n/g,"<br>"),StarWars.animation.find("#intro").html(a),StarWars.animation.find("#episode").text(t.episode),StarWars.animation.find("#title").text(t.title);var o=t.text.split("\n"),e=StarWars.animation.find("#text");e.text("");for(var i in o)e.append($("<p>").text(o[i]));$("#logosvg",StarWars.animation).css("width",$(window).width()+"px"),$("#logoimg",StarWars.animation).css("width",$(window).width()+"px");var n=t.logo?t.logo:"star\nwars",s=n.split("\n"),r=s[0],d=s[1]||"";if("star\nwars"!=n.toLowerCase()){var l=$("#logosvg text",StarWars.animation);l[0].textContent=r,l[1].textContent=d;var u=r.length>d.length?r:d,h="0 0 "+200*u.length+" 500";$("#logosvg",StarWars.animation).each(function(){$(this)[0].setAttribute("viewBox",h)}),$("#logosvg",StarWars.animation).show(),$("#logoimg",StarWars.animation).hide()}else $("#logosvg",StarWars.animation).hide(),$("#logoimg",StarWars.animation).show();var g=function(){$.when(StarWars.audioDefer).then(function(){var t=StarWars.audio.buffered.end(StarWars.audio.buffered.length-1);0!=t||audioIsLoaded?(toggleLoading(),notPlayed=!1,StarWars.play()):($("#loader").hide(),playbutton=$('<div class="verticalWrapper"><div class="playAudio"><button id="playBut" class="playButton" style="font-size: 80px">Play</button></div></div>'),$("body").append(playbutton),$("#playBut",playbutton).click(function(){$("#loader").show(),playbutton.remove()}),StarWars.audio.oncanplaythrough=function(){toggleLoading(),notPlayed=!1,StarWars.play()})})};document.hasFocus()?g():$(window).focus(function(){notPlayed&&g()})}})}catch(o){location.hash="",toggleLoading()}else notPlayed?toggleLoading():(StarWars.reset(),StarWars.resetAudio());ga("send","pageview",{page:location.pathname+location.search+location.hash})}),$(document).ready(function(){window.dispatchEvent(new Event("hashchange"))});