function toggleLoading(){isLoading?($("#loader").hide(),$("#form-starwars").show()):($("#loader").show(),$("#form-starwars").hide()),isLoading=!isLoading}StarWarsOpening=function(){function t(t){this.el=$(t.el),this.audio=this.el.find("audio").get(0),this.start=this.el.find(".start"),this.animation=this.el.find(".animation"),this.reset(),$(this.audio).bind("ended",$.proxy(function(){this.audio.currentTime=0,this.reset(),setTimeout(function(){$("body").removeClass("running")},1e4)},this))}return t.prototype.reset=function(){this.start.show(),$(".pageHide").show(),this.cloned=this.animation.clone(!0),this.animation.remove(),this.animation=this.cloned},t.prototype.resetAudio=function(){this.audio.pause(),this.audio.currentTime=0},t.prototype.play=function(){this.start.hide(),$(".pageHide").hide(),$("body").removeClass("running"),$("body").addClass("running"),this.audio.play(),this.el.append(this.animation)},t}();var StarWars=new StarWarsOpening({el:".starwars"});swal.setDefaults({customClass:"star-wars-alert"}),window.addEventListener("keydown",function(t){var n=document.activeElement.type||"";n.startsWith("text")||[32,37,38,39,40].indexOf(t.keyCode)>-1&&t.preventDefault()},!1);var notPlayed=!0,isLoading=!1,showFooter=!0;toggleLoading(),$("#form-starwars").submit(function(t){t.preventDefault();var n={intro:$("#f-intro").val(),episode:$("#f-episode").val(),title:$("#f-title").val(),text:$("#f-text").val()};$.ajax({url:"https://starwarsopening.firebaseio.com/openings.json",method:"POST",data:JSON.stringify(n),dataType:"json",success:function(t){console.log(t),toggleLoading(),location.hash="!/"+t.name.substring(1)}})}),$(window).on("hashchange",function(){var t=location.hash.replace("#!/","").split("/")[0];if($("body").removeClass("running"),console.log(t),""!=t)try{var n="https://starwarsopening.firebaseio.com/openings/-"+t+".json";console.log(n),$.ajax({url:n,success:function(t){if(toggleLoading(),console.log(t),null==t)return toggleLoading(),void sweetAlert("Oops...","Introduction not found!","error");StarWars.animation.find("#intro").text(t.intro),StarWars.animation.find("#episode").text(t.episode),StarWars.animation.find("#title").text(t.title);var n=t.text.split("\n"),a=StarWars.animation.find("#text");a.text("");for(var e in n)a.append($("<p>").text(n[e]));document.hasFocus()?(StarWars.play(),notPlayed=!1):$(window).focus(function(){notPlayed&&(StarWars.play(),notPlayed=!1)})}})}catch(a){location.hash="",toggleLoading()}else notPlayed?toggleLoading():(StarWars.reset(),StarWars.resetAudio());ga("send","pageview",{page:location.pathname+location.search+location.hash})}),$(document).ready(function(){window.dispatchEvent(new Event("hashchange"))});