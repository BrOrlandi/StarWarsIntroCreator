function toggleLoading(){isLoading?($("#loader").hide(),$("#form-starwars").show()):($("#loader").show(),$("#form-starwars").hide()),isLoading=!isLoading}StarWarsOpening=function(){function t(t){this.el=$(t.el),this.audio=this.el.find("audio").get(0),this.start=this.el.find(".start"),this.animation=this.el.find(".animation"),this.reset(),$(this.audio).bind("ended",$.proxy(function(){this.audio.currentTime=0,this.reset()},this))}return t.prototype.reset=function(){this.start.show(),$("#footer").show(),this.cloned=this.animation.clone(!0),this.animation.remove(),this.animation=this.cloned},t.prototype.resetAudio=function(){this.audio.pause(),this.audio.currentTime=0},t.prototype.play=function(){this.start.hide(),$("#footer").hide(),this.audio.play(),this.el.append(this.animation)},t}();var StarWars=new StarWarsOpening({el:".starwars"});swal.setDefaults({customClass:"star-wars-alert"});var notPlayed=!0,isLoading=!1,showFooter=!0;toggleLoading(),$("#form-starwars").submit(function(t){t.preventDefault();var a={intro:$("#f-intro").val(),episode:$("#f-episode").val(),title:$("#f-title").val(),text:$("#f-text").val()},i=new Firebase("https://starwarsopening.firebaseio.com/openings"),o=i.push(a);console.log(o.key().substring(1)),toggleLoading(),location.hash="!/"+o.key().substring(1)}),$(window).on("hashchange",function(){var t=location.hash.replace("#!/","").split("/")[0];if(console.log(t),""!=t)try{var a=new Firebase("https://starwarsopening.firebaseio.com/openings/-"+t);a.on("value",function(t){toggleLoading();var a=t.val();if(console.log(a),null==a)return void sweetAlert("Oops...","Introduction not found!","error");StarWars.animation.find("#intro").text(a.intro),StarWars.animation.find("#episode").text(a.episode),StarWars.animation.find("#title").text(a.title);var i=a.text.split("\n"),o=StarWars.animation.find("#text");for(var n in i)o.append($("<p>").text(i[n]));document.hasFocus()?(StarWars.play(),notPlayed=!1):$(window).focus(function(){notPlayed&&(StarWars.play(),notPlayed=!1)})},function(t){throw t})}catch(i){location.hash="",toggleLoading()}else notPlayed?toggleLoading():(StarWars.reset(),StarWars.resetAudio());ga("send","pageview",{page:location.pathname+location.search+location.hash})}),$(document).ready(function(){window.dispatchEvent(new Event("hashchange"))});